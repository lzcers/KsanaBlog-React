---
Title: 关于可视化页面构建工具的思考
Tags: 编程 | 前端 | 随想
PublishDate: 2018/06/05 21:30
---

## 引言

现代化的企业管理离不开 IT 系统的支撑，而随着业务和人员的扩张，对 IT 系统及 IT 工具的需求也是日益增长的。

当公司扩张到一定程度时，公司的运作就不能完全依托于人，若是将公司类比于机器，那么要想这部机器能够正常运转，甚至高效运转，那就必须制定合理有效的流程，并研发 IT 系统去承载。

起初我们做事会沉淀一些优秀的实践，随着这些优秀实践的扩散，就会想到将其规范化、标准化、进一步的甚至转换成流程，再将流程用 IT 系统承载使其自动化。

这样就会有很多管理信息系统的开发需求、工具开发需求等，来自业务方的需求尽管很多，但大致都是可以归类的，其主要的差异仅仅是因为业务场景的特殊化，从而需要 IT 工具或系统做一些定制化的开发，甚至新做一个。

这样的成本对公司而言显然是不可接受的，对于程序员来说，重复类似的工作也极易丧失工作动力，那么理所当然的想到如何从这样的重复中脱离出来，而其解决方案就是**可视化页面构建器**，这样的工具相信在不少公司都存在，有用来做活动促销页面的，有用来做中后台管理系统的，有用来做报表的，甚至其它行业的都有，等等。



## 我们为什么需要它？

 对于程序员最大的价值也许只有一个，那就是**Don't Repeat Yourself **，你想每天的工作都是重复的 Copy 后改改改吗？如果有一个可视化的页面构建工具，那么我想是乐于看到的，不用去每天去对接那些千律一篇的需求，而是跟业务说，“嘿，我这有一个工具，你上去托托拽拽配置下就能实现你的需求了。”

也许这样一个工具强大到能够覆盖所有场景的时候，你可能就会担忧自己的工作是否会被替代了，若是这样是否因该思考下自己的工作是否足够有创造性呢，重复无趣的工作被机器替代是不可避免地，但是，这样一个工具能够解决所有的场景，我认为也是不可能的，有一个关于人工智能的笑话 **“有多少人工，就有多少智能。”**，放在这儿，对于这样一个工具，其能力也是需要有程序员去开开发拓展的，因而，这样的页面构建工具**其可扩展性的设计就是重中之重**。

### 那可视化构建工具是万能的吗？

不，至少我不这么认为，软件开发不存在圣杯，也没有银弹。设计并研发一个可视化页面构建工具必须要限定其覆盖场景范围，我们的目的是为了从让程序员从重复中脱离出来，最大程度节省人力成本，而不是将问题甩给业务，“嘿，你自己弄去吧。”

### 可视化构建工具做什么？

可视化构建工具实质是创建了一个低代码平台（甚至无代码），基于各种拖拽，配置等操作**屏蔽**业务对代码的感知。让不具备编码能力或是编码能力偏弱的业务人员也能实现他们的需求。

需求的传递总是会因为沟通过程中的表达和理解不一致造成偏差，因而开发人员若想准确的实现需求，总是免不了改动，若需求的产生到开发都是一个人就能避免很多问题了。

**做为开发人员你会用这样的工具吗？**

我当然不啊，能够抄起键盘就干的事情我为啥要在这页面上托托拽拽配来配去啊，所以这样的工具使用群体肯定就是非专业前端人员，对于个性化强的需求和场景显然也不会是构建工具需要考虑的。

**但是，隐藏在可视化构建工具背后的编码复杂度真的能那么容易屏蔽吗？**

不能，一个功能若是本身很复杂，那么这个构建工具只会将其复杂转换成另外一种形式，比如在这样的工具中，大多数构建操作都是通过拖拽配置来完成的，那么这样的复杂度就会体现在配置上，一堆属性的设置以及依赖，一堆事件的绑定等等，这样就带来了使用成本的增加，用户要使用就需要培训赋能，如果做的太复杂，那我为何不培训赋能业务编码能力呢？

当然，我们可以将其封装的很完美，仅暴露很少配置项，那问题又来了，这就意味着组件自定义能力的降低。

当自定义能力和配置复杂度无法取得平衡，产生冲突的时候，那就不可避免地，需要提供可编程的接口，”这里配置太麻烦了，还是写代码吧“。这样一来为什么不干脆从头到尾编码实现呢。而这样可编程的接口总会带来另外的问题，比如允许用户在拖拽的组件上写样式，样式冲突怎么办，允许用户写 JS ， JS 安全怎么办？如果是服务于企业内部，那么我们可以默认用户是可信的，你要对自己做的东西负责。当然，技术途径也是可以做到的，对 CSS 样式预处理，创建 JS 沙箱，限制只能使用平台的 API 来开发，制定规范等，但是，这样一来，构建工具本身就会很复杂了，或者说我们应该称其为构建平台。



## 可视化构建工具怎么做？

我们确定了构建工具的目标用户和使用范围，那么接下来就是要考虑的几点就是

1. 构建的基本元素

2. 构建的方式

3. 扩展的方式

4. 易用性


**构建的基本元素**

显然，**基于组件（Component** 这一粒度作为构建的基本元素是最合适的，现在前端框架基本上都是组件化开发，已经不再是以前 JQuery 那种到 DOM 层级的控制，基于 DOM 的构建工具这我想起了著名网页制作三剑客之一的 Dreamweaver ，但这玩意应该是死了。

**构建的方式**

**首先要区分设计时和运行时**，既然构建的前提是可视化，而计算机的主要输入设备就是键盘和鼠标，那么可视化操作的途径就仅剩下表单输入配置和拖拽两种形式了。通过拖拽来构建页面就涉及到 **布局管理器(Layout Manager)**的设计和实现，你能拖拽出来的所有页面布局基本就由它限定了，当然我们可以提供多种布局的能力，常见的布局如 GridLayout、FlowLayout 等。

在布局管理器里拖拽组件这样的构建方式是学习成本最少和构建最快速的，因为所见即所得，但是当页面上组件非常多了，结构复杂了怎么办？如何快速的定位到需要操作的组建上？说到页面的结构，我们知道他是一个DOM树，既然如此，我们还需要提供能够**反映出页面建构的组件树**，可以基于它定位到操作的组件，或是直接拖拽树节点来调整页面结构。

我们知道很多系统的布局其实都是类似的，比如中后台管理系统，它们大多是左边一个菜单栏或者顶部菜单栏的形式，然后加上内容区域，对于这样布局类似的系统，我们何不形成**模板**让用户直接调用生成，然后拖拽组件填充内容即可，其它种种大同小异的页面都可如此。

**扩展的方式**

围绕着如何快速构建，除了提供多种模板以外，还要提供足够多的组件，将一些通用性的组件抽象出来由平台提供，但仅仅由平台提供又希望覆盖更多场景那就难了，因此就必需要提供扩展的能力，将第三方开发者拉进来，基于组件去**构建生态**。

将这种扩展能力开放出来，就要考虑制定规范，为使扩展更容易上手，就需要为此提供充分的文档和一些脚手架，而且这种扩展能力的不能局限到某个开发语言或者框架，要尽可能让更多的人参与进来才能使生态形成好的闭环。

...

## 不仅仅页面构建

页面不仅仅是展示，通过拖拽配置我们能解决页面展示的问题，但还有最终要的，交互逻辑又怎么通过可视化的方式去做呢？很多情况下交互逻辑是不可避免的需要写代码，那写哪又是个问题，仅仅是解决写代码，我们有很多的 Web 代码编辑器来解决编码体验的问题，比如把 VSCode 的核心 *Monaco* *Editor*  拿来用。

你让用户写代码了，那运行时的安全怎么保证？

事件、服务、流程、表单、报表等等，又以何种方式去做？

事实上，这样一个工具的实现所牵涉到的问题就不能以工具的眼光去看了，想要一揽子解决所用的问题，那就是一个平台级的解决方案，随着各种云化的思潮，似乎一切皆服务一般，那页面构建器为何不能当作云计算提供的服务之一呢，用户在平台上构建页面，托管运行在云上运行。

...

## 别人怎么做的

- 阿里飞冰
- 阿里云凤蝶 
- 百度 H5
- salesforce platform
- 华为 - 应用开发工厂
- 美团外卖前端可视化界面组装平台 —— 乐高

不管是大厂还是 GitHub 上开源的，这样的工具屡见不鲜，但似乎从来没有流行过？，这样一个构建器的配套设施依赖是很多的，使用和运维这样一个平台成本显然比自己组建一个开发团队代价高，也许未来随着云计算概念的深化，这样的东西才能真正发挥出价值，比如 salesforce  在这方面的投入。

....



## 后记

这是我 17 年某项目工作的回顾，当时也在做这样一个页面构建器开发，从领导拍脑袋到我用 Vue 撸出第一个原型，我一直抱着我才不会用这种东西的想法，随后大量公司自有人力投入，以及很多外围设施的设计，我才想明白它的价值，在公司战略和管理层视角来看，这样的东西确实如同圣杯无异，以致于很多大厂都做这样的东西，光是想想不用代码开发 IT 应用，这样的诱惑是如此之大，以至于让人忽略了拖拽以及配置的复杂度，还有培训赋能的成本，似乎只要不写代码，其它方面复杂些都是可以接受的。

但从一名前端开发者的角度来看，我庆幸参与它的开发，而不是去使用它，我腿没毛病干嘛要拄拐杖，摆脱重复的开发工作我可以多抽象造组件库，造脚手架，然后玩点别的啊。